!function(d,x,u){var n="table2excel",o={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xlsx",exclude_img:!0,exclude_links:!0,exclude_inputs:!0,preserveColors:!1};function l(e,t){this.element=e,this.settings=d.extend({},o,t),this._defaults=o,this._name=n,this.init()}function m(e){return e.filename?e.filename:"table2excel"}l.prototype={init:function(){var a=this;a.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},a.tableRows=[];var s="",i=null;d(a.element).each(function(e,t){var n,o,l="";d(t).find("tr").not(a.settings.exclude).each(function(e,t){s="",a.settings.preserveColors&&(i=getComputedStyle(t),s+=i&&i.backgroundColor?"background-color: "+i.backgroundColor+";":"",s+=i&&i.color?"color: "+i.color+";":""),l+="<tr style='"+s+"'>",d(t).find("td,th").not(a.settings.exclude).each(function(e,t){s="",a.settings.preserveColors&&(i=getComputedStyle(t),s+=i&&i.backgroundColor?"background-color: "+i.backgroundColor+";":"",s+=i&&i.color?"color: "+i.color+";":"");var n=d(this).attr("rowspan"),o=d(this).attr("colspan");0<d(t).find(a.settings.exclude).length?l+="<td> </td>":(l+="<td",0<n&&(l+=" rowspan='"+n+"' "),0<o&&(l+=" colspan='"+o+"' "),s&&(l+=" style='"+s+"'"),l+=">"+d(t).html()+"</td>")}),l+="</tr>"}),a.settings.exclude_img&&(n=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,l=l.replace(/<img[^>]*>/gi,function(e){var t=n.exec(e);return null!==t&&2<=t.length?t[2]:""})),a.settings.exclude_links&&(l=l.replace(/<a[^>]*>|<\/a>/gi,"")),a.settings.exclude_inputs&&(o=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i,l=l.replace(/<input[^>]*>|<\/input>/gi,function(e){var t=o.exec(e);return null!==t&&2<=t.length?t[2]:""})),a.tableRows.push(l)}),a.tableToExcel(a.tableRows,a.settings.name,a.settings.sheetName)},tableToExcel:function(e,t,n){var o,l,a,s,i,r=this,c="";for(o in r.format=function(e,n){return e.replace(/{(\w+)}/g,function(e,t){return n[t]})},n=void 0===n?"Sheet":n,r.ctx={worksheet:t||"Worksheet",table:e,sheetName:n},c=r.template.head,d.isArray(e)&&Object.keys(e).forEach(function(e){c+=r.template.sheet.head+n+e+r.template.sheet.tail}),c+=r.template.mid,d.isArray(e)&&Object.keys(e).forEach(function(e){c+=r.template.table.head+"{table"+e+"}"+r.template.table.tail}),c+=r.template.foot,e)r.ctx["table"+o]=e[o];return delete r.ctx.table,-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==navigator.userAgent.indexOf("Trident")&&-1!==navigator.userAgent.indexOf("rv:11")?"undefined"!=typeof Blob?(c=[c=r.format(c,r.ctx)],s=new Blob(c,{type:"text/html"}),x.navigator.msSaveBlob(s,m(r.settings))):(txtArea1.document.open("text/html","replace"),txtArea1.document.write(r.format(c,r.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,m(r.settings))):(i=new Blob([r.format(c,r.ctx)],{type:"application/vnd.ms-excel"}),x.URL=x.URL||x.webkitURL,l=x.URL.createObjectURL(i),(a=u.createElement("a")).download=m(r.settings),a.href=l,u.body.appendChild(a),a.click(),u.body.removeChild(a)),!0}},d.fn[n]=function(e){var t=this;return t.each(function(){d.data(t,"plugin_"+n)||d.data(t,"plugin_"+n,new l(this,e))}),t}}(jQuery,window,document);